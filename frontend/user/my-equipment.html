<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>GearGuard | My Equipment</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Shared Styles -->
  <link rel="stylesheet" href="../css/auth.css">

  <style>
    .equipment-card {
      background: #ffffff;
      border-radius: 14px;
      padding: 22px;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
    }

    .page-header h4 {
      color: #ffffff;
      font-weight: 600;
    }

    .page-header p {
      color: #e5e7eb;
      font-size: 0.95rem;
      margin-bottom: 0;
    }

    .raise-btn.disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }
  </style>
</head>

<body>

<!-- NAVBAR -->
<nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm">
  <div class="container-fluid px-4">
    <a class="navbar-brand fw-bold" href="user-dashboard.html">GearGuard</a>

    <ul class="navbar-nav ms-auto">
      <li class="nav-item"><a class="nav-link" href="user-dashboard.html">Dashboard</a></li>
      <li class="nav-item"><a class="nav-link active" href="#">My Equipment</a></li>
      <li class="nav-item"><a class="nav-link" href="create-request.html">Create Request</a></li>
      <li class="nav-item"><a class="nav-link" href="my-requests.html">My Requests</a></li>
      <li class="nav-item"><a class="nav-link" href="add-new-equip.html">Add New Equipment</a></li>
      <li class="nav-item">
        <a class="nav-link" href="../common/maintenance-calendar.html">
          Maintenance Calendar
        </a>
      </li>
      <li class="nav-item"><a class="nav-link" href="profile.html">Profile</a></li>
      <li class="nav-item"><a class="nav-link text-danger" href="../auth/login.html">Logout</a></li>
    </ul>
  </div>
</nav>

<!-- MAIN CONTENT -->
<div class="container-fluid px-4 mt-4">

  <!-- PAGE HEADER -->
  <div class="page-header mb-4">
    <h4>My Equipment</h4>
    <p>View and manage your registered equipment</p>
  </div>

  <!-- EQUIPMENT LIST -->
  <div class="row g-4">

    <!-- EQUIPMENT CARD 1 -->
    <div class="col-md-6">
      <div class="equipment-card">

        <h5>Air Conditioner</h5>

        <p class="mb-2">
          <strong>Model:</strong> LG DualCool 2023<br>
          <strong>Status:</strong>
          <span class="badge bg-warning text-dark">Under Maintenance</span><br>
          <strong>Next Maintenance:</strong>
          <span class="next-date">2025-10-05</span>
        </p>

        <button
          class="btn btn-primary raise-btn"
          data-status="UNDER_MAINTENANCE"
          data-next-date="2025-10-05">
          Raise Request
        </button>

        <small class="text-danger d-none info-msg">
          Maintenance already scheduled or in progress.
        </small>

      </div>
    </div>

    <!-- EQUIPMENT CARD 2 -->
    <div class="col-md-6">
      <div class="equipment-card">

        <h5>Generator</h5>

        <p class="mb-2">
          <strong>Model:</strong> Kirloskar 550<br>
          <strong>Status:</strong>
          <span class="badge bg-success">Active</span><br>
          <strong>Next Maintenance:</strong>
          <span class="next-date">2025-10-20</span>
        </p>

        <button
          class="btn btn-primary raise-btn"
          data-status="ACTIVE"
          data-next-date="2025-10-20">
          Raise Request
        </button>

        <small class="text-danger d-none info-msg">
          Upcoming maintenance scheduled soon.
        </small>

      </div>
    </div>

    <!-- EQUIPMENT CARD 3 -->
    <div class="col-md-6">
      <div class="equipment-card">

        <h5>Printer</h5>

        <p class="mb-2">
          <strong>Model:</strong> HP LaserJet Pro<br>
          <strong>Status:</strong>
          <span class="badge bg-success">Active</span><br>
          <strong>Next Maintenance:</strong>
          <span class="next-date">2025-11-15</span>
        </p>

        <button
          class="btn btn-primary raise-btn"
          data-status="ACTIVE"
          data-next-date="2025-11-15">
          Raise Request
        </button>

        <small class="text-danger d-none info-msg">
          Upcoming maintenance scheduled soon.
        </small>

      </div>
    </div>

  </div>

</div>

<!-- JS LOGIC -->
<script>
  const DAYS_THRESHOLD = 7;

  function isMaintenanceNear(dateStr) {
    const today = new Date();
    const maintenanceDate = new Date(dateStr);
    const diffDays =
      (maintenanceDate - today) / (1000 * 60 * 60 * 24);
    return diffDays >= 0 && diffDays <= DAYS_THRESHOLD;
  }

  document.querySelectorAll(".raise-btn").forEach((btn) => {
    const status = btn.dataset.status;
    const nextDate = btn.dataset.nextDate;
    const infoMsg = btn.nextElementSibling;

    if (
      status === "UNDER_MAINTENANCE" ||
      (nextDate && isMaintenanceNear(nextDate))
    ) {
      btn.disabled = true;
      btn.classList.add("disabled");
      infoMsg.classList.remove("d-none");
    }
  });
</script>

</body>
</html>
