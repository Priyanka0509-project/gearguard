<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>GearGuard | Assigned Jobs</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Shared Styles -->
  <link rel="stylesheet" href="../css/auth.css">

  <style>
    .page-header h4 {
      color: #ffffff;
      font-weight: 600;
    }

    .page-header p {
      color: #e5e7eb;
      font-size: 0.95rem;
    }

    .job-card {
      background: #ffffff;
      border-radius: 14px;
      padding: 22px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.1);
    }
  </style>
</head>

<body>

<!-- TEAM NAVBAR -->
<nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm">
  <div class="container-fluid px-4">
    <a class="navbar-brand fw-bold" href="team-dashboard.html">GearGuard</a>

    <ul class="navbar-nav ms-auto">
      <li class="nav-item">
        <a class="nav-link" href="team-dashboard.html">Dashboard</a>
      </li>
      <li class="nav-item">
        <a class="nav-link active" href="#">Assigned Jobs</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="../common/maintenance-calendar.html">
          Maintenance Calendar
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="team-profile.html">Profile</a>
      </li>
      <li class="nav-item">
        <a class="nav-link text-danger" href="../auth/login.html">Logout</a>
      </li>
    </ul>
  </div>
</nav>

<!-- MAIN CONTENT -->
<div class="container-fluid px-4 mt-4">

  <!-- HEADER -->
  <div class="page-header mb-4">
    <h4>Assigned Jobs</h4>
    <p>View and manage your maintenance tasks</p>
  </div>

  <!-- JOB LIST -->
  <div class="row g-4">

    <!-- JOB CARD -->
    <div class="col-md-6">
      <div class="job-card">

        <h6>Air Conditioner</h6>

        <p class="mb-2">
          <strong>Model:</strong> LG DualCool 2023<br>
          <strong>Scheduled:</strong> 18 Oct 2025<br>
          <strong>Status:</strong>
          <span class="badge bg-info status-badge">Assigned</span>
        </p>

        <button
          class="btn btn-sm btn-primary action-btn"
          onclick="handleJobAction(this)">
          Start Work
        </button>

      </div>
    </div>

    <!-- JOB CARD -->
    <div class="col-md-6">
      <div class="job-card">

        <h6>Generator</h6>

        <p class="mb-2">
          <strong>Model:</strong> Kirloskar 550<br>
          <strong>Scheduled:</strong> 20 Oct 2025<br>
          <strong>Status:</strong>
          <span class="badge bg-info status-badge">Assigned</span>
        </p>

        <button
          class="btn btn-sm btn-primary action-btn"
          onclick="handleJobAction(this)">
          Start Work
        </button>

      </div>
    </div>

  </div>

</div>

<!-- COMPLETION REPORT MODAL -->
<div class="modal fade" id="reportModal" tabindex="-1">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">

      <div class="modal-header">
        <h5 class="modal-title">Maintenance Completion Report</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>

      <div class="modal-body">

        <div class="mb-3">
          <label class="form-label">Work Summary</label>
          <textarea class="form-control" rows="3"
                    placeholder="Describe the work done"></textarea>
        </div>

        <div class="mb-3">
          <label class="form-label">Parts Replaced (optional)</label>
          <input type="text" class="form-control"
                 placeholder="e.g. Compressor, Filter">
        </div>

        <div class="mb-3">
          <label class="form-label">Time Spent (hours)</label>
          <input type="number" class="form-control" min="0">
        </div>

      </div>

      <div class="modal-footer">
        <button class="btn btn-success" onclick="submitReport()">
          Submit Report
        </button>
      </div>

    </div>
  </div>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
  function handleJobAction(button) {
    const card = button.closest(".job-card");
    const statusBadge = card.querySelector(".status-badge");

    // START WORK → IN PROGRESS
    if (statusBadge.innerText === "Assigned") {
      statusBadge.innerText = "In Progress";
      statusBadge.className = "badge bg-warning status-badge";

      button.innerText = "Mark Completed";
      button.className = "btn btn-sm btn-success action-btn";
      return;
    }

    // MARK COMPLETED → OPEN REPORT
    if (statusBadge.innerText === "In Progress") {
      const modal = new bootstrap.Modal(
        document.getElementById("reportModal")
      );
      modal.show();
    }
  }

  function submitReport() {
    alert("Job completed and report submitted successfully!");
    bootstrap.Modal.getInstance(
      document.getElementById("reportModal")
    ).hide();
  }
</script>

</body>
</html>
